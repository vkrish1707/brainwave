SELECT
  COALESCE(h.EBVP_TOP_NODE, t.EBVP_TOP_NODE, ht.EBVP_TOP_NODE, tt.EBVP_TOP_NODE) AS EBVP_TOP_NODE,
  COALESCE(h.EBVP_TOP_NODE_2, t.EBVP_TOP_NODE_2, ht.EBVP_TOP_NODE_2, tt.EBVP_TOP_NODE_2) AS EBVP_TOP_NODE_2,
  COALESCE(h.EBVP_TOP_NODE_3, t.EBVP_TOP_NODE_3, ht.EBVP_TOP_NODE_3, tt.EBVP_TOP_NODE_3) AS EBVP_TOP_NODE_3,

  COUNT(DISTINCT h.EMPLOYEE_ID) AS total_hires,
  COUNT(DISTINCT t.EMPLOYEE_ID) AS total_terminations,
  COUNT(DISTINCT ht.EMPLOYEE_ID) - COUNT(DISTINCT tt.EMPLOYEE_ID) AS net_transfers

FROM hires h
FULL OUTER JOIN terms t
  ON h.EBVP_TOP_NODE = t.EBVP_TOP_NODE
 AND h.EBVP_TOP_NODE_2 = t.EBVP_TOP_NODE_2
 AND h.EBVP_TOP_NODE_3 = t.EBVP_TOP_NODE_3

FULL OUTER JOIN hire_transfers ht
  ON h.EBVP_TOP_NODE = ht.EBVP_TOP_NODE
 AND h.EBVP_TOP_NODE_2 = ht.EBVP_TOP_NODE_2
 AND h.EBVP_TOP_NODE_3 = ht.EBVP_TOP_NODE_3

FULL OUTER JOIN term_transfers tt
  ON h.EBVP_TOP_NODE = tt.EBVP_TOP_NODE
 AND h.EBVP_TOP_NODE_2 = tt.EBVP_TOP_NODE_2
 AND h.EBVP_TOP_NODE_3 = tt.EBVP_TOP_NODE_3

GROUP BY
  COALESCE(h.EBVP_TOP_NODE, t.EBVP_TOP_NODE, ht.EBVP_TOP_NODE, tt.EBVP_TOP_NODE),
  COALESCE(h.EBVP_TOP_NODE_2, t.EBVP_TOP_NODE_2, ht.EBVP_TOP_NODE_2, tt.EBVP_TOP_NODE_2),
  COALESCE(h.EBVP_TOP_NODE_3, t.EBVP_TOP_NODE_3, ht.EBVP_TOP_NODE_3, tt.EBVP_TOP_NODE_3)