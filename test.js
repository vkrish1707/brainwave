SELECT
    WEEK_NUM,
    EBVP_TOP_NODE,
    EBVP_TOP_NODE_2,
    EBVP_TOP_NODE_3,
    COUNT(*) AS offer
FROM (
    SELECT WEEK_NUM, EBVP_TOP_NODE, EBVP_TOP_NODE_2, EBVP_TOP_NODE_3
    FROM global_hires
    WHERE RIGHT(WEEK_NUM, 2) = '25'

    UNION ALL

    SELECT WEEK_NUM, EBVP_TOP_NODE, EBVP_TOP_NODE_2, EBVP_TOP_NODE_3
    FROM global_hire_transfers
    WHERE RIGHT(WEEK_NUM, 2) = '25'
) AS combined_offers
GROUP BY
    WEEK_NUM,
    EBVP_TOP_NODE,
    EBVP_TOP_NODE_2,
    EBVP_TOP_NODE_3;